import{M as P,u as D,ea as I,r as o,b6 as z,o as m,i as y,j as l,k as e,y as _,D as B,K as k,s as u,n as f,I as h,J as v,t as V,Q as b,q as U,E as F,G as M,l as S,x as N,F as j,v as A,z as O,L as R,m as $}from"./ec0ef80e.js";import{Q as C}from"./98e0875c.js";import{Q as E,a as T,b as G}from"./8ccb46ba.js";import{Q as J,C as K}from"./bf4a8154.js";import{Q as H}from"./b7951823.js";import{Q as W,a as X}from"./51996ac8.js";import{u as Y}from"./946466bb.js";import{o as Z}from"./5509e1c4.js";import"./780fb64b.js";const me=P({__name:"LoginView",setup(ee){const Q=Y();Q.dark.set(!0);const n=D(),p=I(),g=o(null),w=o(null),s=z({username:"demo",password:"h23j342ASDbn45uiaDashnj4k"}),c=o("123456"),i=o(!1),d=o(!0),x=o([]);async function q(){try{const{totp:r}=await n.checkCredentials(s);r?i.value=!0:p.push({name:"TOTPSetup"})}catch(r){console.error(r)}}async function L(){try{await n.login({...s,twofactor:c.value}),n.next?(p.push(n.next),n.next=null):p.push({name:"Dashboard"})}catch(r){console.error(r)}finally{g.value?.reset(),w.value?.reset(),i.value=!1}}return(r,a)=>(m(),y(X,null,{default:l(()=>[e(W,null,{default:l(()=>[e(H,{class:"flex bg-image flex-center"},{default:l(()=>[e(_,{style:B(k(Q).screen.lt.sm?{width:"80%"}:{width:"30%"})},{default:l(()=>[e(u,null,{default:l(()=>a[5]||(a[5]=[f("div",{class:"text-center q-pt-lg"},[f("div",{class:"col text-h4 ellipsis"},"Tactical RMM")],-1)])),_:1}),e(u,null,{default:l(()=>[e(C,{ref_key:"form",ref:g,onSubmit:h(q,["prevent"]),class:"q-gutter-md"},{default:l(()=>[e(v,{filled:"",modelValue:s.username,"onUpdate:modelValue":a[0]||(a[0]=t=>s.username=t),label:"Username","lazy-rules":"",rules:[t=>t&&t.length>0||"This field is required"]},null,8,["modelValue","rules"]),e(v,{modelValue:s.password,"onUpdate:modelValue":a[2]||(a[2]=t=>s.password=t),filled:"",type:d.value?"password":"text",label:"Password","lazy-rules":"",rules:[t=>t&&t.length>0||"This field is required"]},{append:l(()=>[e(V,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[1]||(a[1]=t=>d.value=!d.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),f("div",null,[e(b,{label:"Login",type:"submit",color:"primary",class:"full-width"})])]),_:1},512)]),_:1}),x.value?.length>0?(m(),y(u,{key:0},{default:l(()=>[a[6]||(a[6]=f("div",{class:"text-h6 text-center q-mb-md"},"Log in with SSO",-1)),e(U),e(J,{dense:"",bordered:"",class:"q-pa-sm"},{default:l(()=>[(m(!0),F(j,null,M(x.value,t=>(m(),y(E,{key:t.id,onClick:te=>k(Z)(t.id),clickable:"",class:"q-pa-xs hover-bg"},{default:l(()=>[e(T,{avatar:""},{default:l(()=>[e(V,{name:t.icon??"mdi-key",size:"sm",class:"text-primary"},null,8,["name"])]),_:2},1024),e(T,null,{default:l(()=>[e(G,null,{default:l(()=>[S(N(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):A("",!0)]),_:1},8,["style"]),e(O,{persistent:"",modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=t=>i.value=t)},{default:l(()=>[e(_,{style:{"min-width":"400px"}},{default:l(()=>[e(C,{ref_key:"formToken",ref:w,onSubmit:h(L,["prevent"])},{default:l(()=>[e(u,{class:"text-center text-h6"},{default:l(()=>a[7]||(a[7]=[S("Two-Factor Token")])),_:1}),e(u,null,{default:l(()=>[e(v,{autofocus:"",outlined:"",autocomplete:"one-time-code",modelValue:c.value,"onUpdate:modelValue":a[3]||(a[3]=t=>c.value=t),rules:[t=>t&&t.length>0||"This field is required"]},null,8,["modelValue","rules"])]),_:1}),e(R,{align:"right",class:"text-primary"},{default:l(()=>[$(e(b,{flat:"",label:"Cancel"},null,512),[[K]]),e(b,{flat:"",label:"Submit",type:"submit"})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}});export{me as default};
